// Generated by CoffeeScript 1.12.5
var BodyParser, express, expressApp, fs, ini;

express = require("express");

expressApp = express();

ini = require("ini");

fs = require("fs");

BodyParser = require("body-parser");

expressApp.listen(3000);

expressApp.use(express["static"]('public'));

expressApp.get("/GET/data/config/", function(req, res) {
  return res.send(ini.parse(fs.readFileSync("./data/config.ini", 'utf-8')));
});

expressApp.get("/GET/data/lang/", function(req, res) {
  var Parsed;
  Parsed = ini.parse(fs.readFileSync("./data/config.ini", "utf-8"));
  return res.send(ini.parse(fs.readFileSync("./data/lang/" + Parsed.OPTION.lang + ".ini", 'utf-8')));
});

expressApp.get("/PUT/data/config/", function(req, res) {
  var iniFile;
  if (req.query["config.option.instalx"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.OPTION.instalX = req.query["config.option.instalx"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
  }
  if (req.query["config.user.chanel"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.USER.chanel = req.query["config.user.chanel"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
  }
  if (req.query["config.user.username"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.USER.username = req.query["config.user.username"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
  }
  if (req.query["config.user.password"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.USER.password = req.query["config.user.password"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
  }
  if (req.query["config.bot.color"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.BOT.color = req.query["config.bot.color"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
    console.log("set");
  }
  return res.send("ok");
});

expressApp.get("/SET/data/config/", function(req, res) {
  var iniFile;
  if (req.query["config.bot.start"]) {
    iniFile = ini.parse(fs.readFileSync("./data/config.ini", 'utf-8'));
    iniFile.BOT.start = req.query["config.bot.start"];
    fs.writeFileSync("./data/config.ini", ini.stringify(iniFile));
  }
  return res.send("ok");
});
